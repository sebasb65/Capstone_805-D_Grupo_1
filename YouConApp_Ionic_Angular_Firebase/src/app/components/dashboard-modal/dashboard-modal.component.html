<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Resumen Financiero</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon name="close-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding dashboard-content">
  
  <ion-grid>
    <ion-row>
      
      <ion-col size="12">
        <ion-card class="stat-card balance" [ngClass]="{'positive': (balanceGeneral$ | async)! >= 0, 'negative': (balanceGeneral$ | async)! < 0}">
          <ion-card-content>
            <div class="card-icon">
              <ion-icon name="wallet-outline"></ion-icon>
            </div>
            <div class="card-info">
              <ion-label>Balance General</ion-label>
              <h1>{{ (balanceGeneral$ | async) | currency:'CLP ':'symbol':'1.0-0' }}</h1>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <ion-col size="12" size-md="4">
        <ion-card class="stat-card success">
          <ion-card-content>
            <ion-icon name="trending-up-outline" color="success"></ion-icon>
            <div class="data">
              <ion-label>Total Ingresos</ion-label>
              <h2>{{ (totalIngresos$ | async) | currency:'CLP ':'symbol':'1.0-0' }}</h2>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <ion-col size="6" size-md="4">
        <ion-card class="stat-card danger">
          <ion-card-content>
            <ion-icon name="trending-down-outline" color="danger"></ion-icon>
            <div class="data">
              <ion-label>Gastos</ion-label>
              <h2>{{ (totalGastos$ | async) | currency:'CLP ':'symbol':'1.0-0' }}</h2>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <ion-col size="6" size-md="4">
        <ion-card class="stat-card warning">
          <ion-card-content>
            <ion-icon name="people-outline" color="warning"></ion-icon>
            <div class="data">
              <ion-label>Mano de Obra</ion-label>
              <h2>{{ (costoManoDeObra$ | async) | currency:'CLP ':'symbol':'1.0-0' }}</h2>
            </div>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <div class="chart-container" *ngIf="chartData$ | async as data">
    <h3 class="chart-title">Distribuci√≥n Financiera</h3>
    
    <ngx-charts-bar-vertical
      [results]="data"
      [scheme]="colorScheme"
      [gradient]="true"
      [xAxis]="true"
      [yAxis]="true"
      [legend]="false"
      [showXAxisLabel]="false"
      [showYAxisLabel]="false"
      [barPadding]="15" 
      [roundEdges]="true">
    </ngx-charts-bar-vertical>
  </div>

  <ion-button 
    expand="block" 
    color="medium" 
    fill="outline" 
    class="ion-margin-top ion-margin-bottom"
    (click)="dismiss()">
    Volver al Inicio
  </ion-button>

</ion-content>